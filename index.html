<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Мой Mini App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body { margin:0; font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial;
           background: var(--tg-theme-bg-color); color: var(--tg-theme-text-color); }
    .wrap { padding:16px; }
    button { border:0; border-radius:10px; padding:14px 18px; cursor:pointer;
             background: var(--tg-theme-button-color); color: var(--tg-theme-button-text-color); }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Привет из Mini App</h1>
    <p id="who">Загружаю…</p>
    <button id="send">Отправить данные боту</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // Показать имя, если открыто внутри Telegram
    const u = tg.initDataUnsafe?.user;
    document.getElementById('who').textContent = u
      ? `Вы: ${u.first_name} ${u.last_name || ''}`.trim()
      : 'Открыто вне Telegram (данных о пользователе нет)';

    // Кнопка отправки данных обратно боту
    document.getElementById('send').onclick = () => {
      tg.sendData(JSON.stringify({
        event: 'button_click',
        ts: Date.now(),
        note: 'hello from miniapp'
      }));
      tg.showPopup({ title: 'Отправлено', message: 'Данные ушли боту ✅' });
    };
  </script>
</body>
</html>
